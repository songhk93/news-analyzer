<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>기사 목록 - 뉴스 키워드 분석 서비스</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="/">뉴스 키워드 분석</a>
            <div class="navbar-nav">
                <a class="nav-link" href="/">홈</a>
                <a class="nav-link" href="/articles">기사 목록</a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <h2>저장된 기사 목록</h2>
        <button class="btn btn-primary mb-3" onclick="loadKeywords()">키워드 재설정</button>
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>제목</th>
                        <th>기사작성날짜</th>
                        <th>도메인</th>
                        <th>기사내용</th>
                        <th>작업</th>
                    </tr>
                </thead>
                <tbody id="articlesTableBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        function loadArticles() {
            fetch('/api/articles')
                .then(response => response.json())
                .then(data => {
                    const tbody = document.getElementById('articlesTableBody');
                    tbody.innerHTML = '';
                    data.forEach(article => {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>${article.seq}</td>
                            <td><a href="${article.url}" target="_blank">${article.title}</a></td>
                            <td>${article.date}</td>
                            <td>${article.domain}</td>
                            <td>${article.content.substring(0, 100)}...</td>
                            <td>
                                <button class="btn btn-danger btn-sm" onclick="deleteArticle(${article.seq})">삭제</button>
                            </td>
                        `;
                        tbody.appendChild(tr);
                    });
                });
        }

        function deleteArticle(seq) {
            if (confirm('이 기사를 삭제하시겠습니까?')) {
                fetch(`/api/delete_article/${seq}`, {
                    method: 'DELETE'
                })
                .then(response => response.json())
                .then(data => {
                    alert(data.message);
                    loadArticles();
                })
                .catch(error => {
                    alert('오류가 발생했습니다: ' + error);
                });
            }
        }

        function loadKeywords() {
            fetch('/api/keywords')
                .then(response => response.json())
                .then(data => {
                    alert('키워드가 재설정되었습니다.');
                });
        }

        // 페이지 로드 시 기사 목록 로드
        document.addEventListener('DOMContentLoaded', loadArticles);
    </script>
</body>
</html>
